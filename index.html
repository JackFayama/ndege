<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Aviator Game</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            background-color: #0f172a;
            color: white;
            font-family: sans-serif;
        }

        #modalPopup {
            display: flex;
            align-items: center;
            justify-content: center;
        }
    </style>
</head>
<body class="flex flex-col items-center justify-center min-h-screen p-4">

    <div class="text-3xl font-bold mb-6">Aviator Game</div>
    <div class="text-xl mb-2">Balance: <span id="balance">1000</span></div>
    <div class="text-2xl mb-4">Multiplier: <span id="multiplier">1.00x</span></div>

    <!-- Bet areas -->
    <div class="grid grid-cols-1 gap-4 w-full max-w-md">
        <div class="bg-gray-800 p-4 rounded-lg" id="bet1-area">
            <input id="amount_bet1" type="number" class="w-full mb-2 p-2 rounded text-black" placeholder="Enter amount">
            <button id="bet_bet1" class="w-full bg-green-500 text-white py-2 rounded" onclick="handleBet('bet1')">BET</button>
            <button id="auto_bet1" onclick="toggleAuto('bet1')" class="bg-gray-700 px-3 py-1 mt-2 rounded">Auto</button>
        </div>
        <div class="bg-gray-800 p-4 rounded-lg" id="bet2-area">
            <input id="amount_bet2" type="number" class="w-full mb-2 p-2 rounded text-black" placeholder="Enter amount">
            <button id="bet_bet2" class="w-full bg-green-500 text-white py-2 rounded" onclick="handleBet('bet2')">BET</button>
            <button id="auto_bet2" onclick="toggleAuto('bet2')" class="bg-gray-700 px-3 py-1 mt-2 rounded">Auto</button>
        </div>
    </div>

    <!-- Modal -->
    <div id="modalPopup" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center z-50">
        <div class="bg-white text-black rounded-xl p-6 w-80 text-center">
            <h2 id="modalTitle" class="text-xl font-bold mb-2">Notification</h2>
            <p id="modalMessage" class="mb-4">Message</p>
            <button onclick="closeModal()" class="bg-red-500 text-white px-4 py-2 rounded">Close</button>
        </div>
    </div>

    <script>
        let multiplier = 1;
        let crashPoint = parseFloat(localStorage.getItem("crashPoint")) || getRandomCrashPoint();
        let interval;
        let isRunning = localStorage.getItem("isRunning") === "true";
        let gameStartTime = parseFloat(localStorage.getItem("gameStartTime")) || Date.now();
        let balance = parseFloat(localStorage.getItem("balance")) || 1000;

        const bets = {
            bet1: { amount: 0, active: false, multiplierStart: 1, auto: false, queued: false },
            bet2: { amount: 0, active: false, multiplierStart: 1, auto: false, queued: false }
        };

        function getRandomCrashPoint() {
            return (Math.random() * 10 + 1).toFixed(2);
        }

        function updateMultiplier() {
            const elapsed = (Date.now() - gameStartTime) / 1000;
            multiplier = (1 + elapsed * 0.1).toFixed(2);
            document.getElementById("multiplier").textContent = multiplier + "x";

            if (parseFloat(multiplier) >= parseFloat(crashPoint)) {
                stopGame();
            }

            Object.keys(bets).forEach(id => {
                if (bets[id].active) {
                    updateBetButtonLabel(id);
                }
            });
        }

        function handleBet(id) {
            if (!isRunning) return showModal("Game not running", "Wait for next round.");

            if (bets[id].active) {
                cashOut(id);
            } else {
                const input = document.getElementById(`amount_${id}`);
                const amount = parseFloat(input.value);
                if (isNaN(amount) || amount <= 0) return showModal("Invalid Amount", "Please enter a valid amount.");
                if (amount > balance) return showModal("Insufficient Balance", "You do not have enough balance.");

                balance -= amount;
                bets[id].amount = amount;
                bets[id].multiplierStart = parseFloat(multiplier);
                bets[id].active = true;
                setButtonToCashout(id);
                updateBalance();
                saveState();
            }
        }

        function setButtonToCashout(id) {
            const btn = document.getElementById(`bet_${id}`);
            btn.textContent = "CASH OUT";
            btn.classList.remove("bg-green-500");
            btn.classList.add("bg-blue-500");
        }

        function setButtonToBet(id) {
            const btn = document.getElementById(`bet_${id}`);
            btn.textContent = "BET";
            btn.classList.remove("bg-blue-500");
            btn.classList.add("bg-green-500");
        }

        function updateBetButtonLabel(id) {
            const btn = document.getElementById(`bet_${id}`);
            const current = (bets[id].amount * (multiplier / bets[id].multiplierStart)).toFixed(2);
            btn.textContent = `CASH OUT ${current}`;
        }

        function cashOut(id) {
            const profit = bets[id].amount * (multiplier / bets[id].multiplierStart);
            balance += profit;
            showModal("Cash Out", `You cashed out ${profit.toFixed(2)}!`);
            bets[id].amount = 0;
            bets[id].active = false;
            setButtonToBet(id);
            updateBalance();
            saveState();
        }

        function updateBalance() {
            document.getElementById("balance").textContent = balance.toFixed(2);
            localStorage.setItem("balance", balance.toFixed(2));
        }

        function stopGame() {
            clearInterval(interval);
            isRunning = false;
            localStorage.setItem("isRunning", false);

            Object.keys(bets).forEach(id => {
                if (bets[id].active) {
                    bets[id].active = false;
                    setButtonToBet(id);
                }
                if (bets[id].queued || bets[id].auto) {
                    placeNextRound(id);
                }
            });

            saveState();
            setTimeout(() => {
                startGame();
            }, 3000);
        }

        function startGame() {
            multiplier = 1;
            crashPoint = getRandomCrashPoint();
            localStorage.setItem("crashPoint", crashPoint);
            gameStartTime = Date.now();
            localStorage.setItem("gameStartTime", gameStartTime);
            isRunning = true;
            localStorage.setItem("isRunning", true);
            interval = setInterval(updateMultiplier, 100);
        }

        function toggleAuto(id) {
            bets[id].auto = !bets[id].auto;
            const btn = document.getElementById(`auto_${id}`);
            if (bets[id].auto) {
                btn.classList.remove("bg-gray-700");
                btn.classList.add("bg-blue-500");
            } else {
                btn.classList.remove("bg-blue-500");
                btn.classList.add("bg-gray-700");
            }
            saveState();
        }

        function placeNextRound(id) {
            const input = document.getElementById(`amount_${id}`);
            const amount = parseFloat(input.value);
            if (!isNaN(amount) && amount > 0 && amount <= balance) {
                balance -= amount;
                bets[id].amount = amount;
                bets[id].multiplierStart = 1;
                bets[id].active = true;
                bets[id].queued = false;
                setButtonToCashout(id);
                updateBalance();
                saveState();
            }
        }

        function showModal(title, message) {
            document.getElementById("modalTitle").textContent = title;
            document.getElementById("modalMessage").textContent = message;
            document.getElementById("modalPopup").classList.remove("hidden");
        }

        function closeModal() {
            document.getElementById("modalPopup").classList.add("hidden");
        }

        function saveState() {
            localStorage.setItem("balance", balance);
            localStorage.setItem("bets", JSON.stringify(bets));
        }

        function restoreButtonStates() {
            Object.keys(bets).forEach(id => {
                if (bets[id].active) {
                    setButtonToCashout(id);
                } else {
                    setButtonToBet(id);
                }
                updateBetButtonLabel(id);

                const autoBtn = document.getElementById(`auto_${id}`);
                if (bets[id].auto) {
                    autoBtn.classList.add("bg-blue-500");
                    autoBtn.classList.remove("bg-gray-700");
                } else {
                    autoBtn.classList.add("bg-gray-700");
                    autoBtn.classList.remove("bg-blue-500");
                }
            });
        }

        window.onload = () => {
            const savedBets = JSON.parse(localStorage.getItem("bets"));
            if (savedBets) {
                Object.assign(bets, savedBets);
            }
            updateBalance();
            restoreButtonStates();

            if (isRunning) {
                interval = setInterval(updateMultiplier, 100);
            }
        };
    </script>
</body>
</html>

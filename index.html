<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>Aviator Game</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            background-color: #0f172a;
            color: white;
            font-family: sans-serif;
        }
    </style>
</head>
<body class="min-h-screen flex flex-col items-center justify-start py-4 px-2">
    <!-- Header -->
    <div class="w-full max-w-5xl bg-gray-900 rounded-lg p-4 flex justify-between items-center">
        <div class="text-red-500 text-2xl font-bold">Aviator</div>
       <span 
  class="text-green-400 font-bold cursor-pointer hover:underline" 
  id="balance"
  onclick="document.getElementById('balanceModal').classList.remove('hidden')">KES 0.00</span> 
</div>

    <!-- Game Area -->
    <div class="w-full max-w-5xl bg-gray-800 mt-4 p-4 rounded-xl flex flex-col items-center">
        <div class="bg-yellow-500 w-full text-center py-1 rounded-t-md font-bold">FUN MODE</div>
        <div class="bg-black w-full flex flex-col justify-center items-center py-12 rounded-b-md">
            <div id="multiplierDisplay" class="text-6xl font-bold text-purple-400">1.00x</div>
        </div>
    </div>

    <!-- Betting Area -->
    <div class="w-full max-w-5xl grid grid-cols-1 md:grid-cols-2 gap-4 mt-4">
        <!-- Bet 1 -->
        <div class="bg-gray-900 rounded-xl p-4">
            <div class="bg-gray-800 rounded-lg p-3">
                <div class="flex justify-between mb-2">
                    <button class="bg-gray-700 px-3 py-1 rounded">Bet</button>
                    <button class="bg-gray-700 px-3 py-1 rounded">Auto</button>
                </div>
                <div class="flex items-center space-x-2 mb-2">
                    <button onclick="decreaseBet('bet1')" class="bg-gray-700 px-3 py-1 rounded">-</button>
                    <input id="bet1" type="number" class="w-full text-center bg-gray-800 text-white py-1 rounded" value="10.00">
                    <button onclick="increaseBet('bet1')" class="bg-gray-700 px-3 py-1 rounded">+</button>
                </div>
                <div class="grid grid-cols-3 gap-2 mb-2">
                    <button onclick="setBet('bet1', 100)" class="bg-gray-700 py-1 rounded">100</button>
                    <button onclick="setBet('bet1', 200)" class="bg-gray-700 py-1 rounded">200</button>
                    <button onclick="setBet('bet1', 500)" class="bg-gray-700 py-1 rounded">500</button>
                    <button onclick="setBet('bet1', 10000)" class="bg-gray-700 py-1 rounded col-span-3">10,000</button>
                </div>
                <button onclick="placeBet('bet1')" class="w-full bg-green-500 py-2 rounded text-white font-bold">Bet <span id="bet1Amount">10.00</span> KES</button>
            </div>
        </div>

        <!-- Bet 2 -->
        <div class="bg-gray-900 rounded-xl p-4">
            <div class="bg-gray-800 rounded-lg p-3">
                <div class="flex justify-between mb-2">
                    <button class="bg-gray-700 px-3 py-1 rounded">Bet</button>
                    <button class="bg-gray-700 px-3 py-1 rounded">Auto</button>
                </div>
                <div class="flex items-center space-x-2 mb-2">
                    <button onclick="decreaseBet('bet2')" class="bg-gray-700 px-3 py-1 rounded">-</button>
                    <input id="bet2" type="number" class="w-full text-center bg-gray-800 text-white py-1 rounded" value="10.00">
                    <button onclick="increaseBet('bet2')" class="bg-gray-700 px-3 py-1 rounded">+</button>
                </div>
                <div class="grid grid-cols-3 gap-2 mb-2">
                    <button onclick="setBet('bet2', 100)" class="bg-gray-700 py-1 rounded">100</button>
                    <button onclick="setBet('bet2', 200)" class="bg-gray-700 py-1 rounded">200</button>
                    <button onclick="setBet('bet2', 500)" class="bg-gray-700 py-1 rounded">500</button>
                    <button onclick="setBet('bet2', 10000)" class="bg-gray-700 py-1 rounded col-span-3">10,000</button>
                </div>
                <button onclick="placeBet('bet2')" class="w-full bg-green-500 py-2 rounded text-white font-bold">Bet <span id="bet2Amount">10.00</span> KES</button>
            </div>
        </div>
    </div>

    <!-- Modal (fixed and now works properly) -->
    <div id="modalPopup" class="fixed inset-0 bg-black bg-opacity-50 hidden z-50 flex justify-center items-center">
        <div class="bg-white text-black rounded-xl p-6 w-80 text-center">
            <h2 id="modalTitle" class="text-xl font-bold mb-2">Notification</h2>
            <p id="modalMessage" class="mb-4">Message</p>
            <button onclick="closeModal()" class="bg-red-500 text-white px-4 py-2 rounded">Close</button>
        </div>
    </div>

<!-- Main Action Modal (Updated with side-by-side buttons) -->
<div id="balanceModal" class="fixed inset-0 bg-black bg-opacity-50 hidden z-50 flex justify-center items-center">
    <div class="bg-white text-black rounded-xl p-6 w-96 text-center">
        <h2 class="text-xl font-bold mb-4">Balance Options</h2>
        <div class="flex justify-between gap-4">
            <button onclick="openDepositMethod()" class="flex-1 bg-blue-500 text-white py-3 rounded-lg font-bold">Deposit</button>
            <button onclick="openWithdrawModal()" class="flex-1 bg-yellow-500 text-white py-3 rounded-lg font-bold">Withdraw</button>
        </div>
    </div>
</div>

<!-- Deposit Method Modal (Updated with Side-by-Side Images) -->
<div id="depositMethodModal" class="fixed inset-0 bg-black bg-opacity-50 hidden z-50 flex justify-center items-center">
    <div class="bg-white text-black rounded-xl p-6 w-96 text-center">
        <h2 class="text-xl font-bold mb-4">Choose Payment Method</h2>
        <div class="flex justify-between gap-4">
            <button onclick="showPaymentInstructions('M-PESA')" class="flex-1 bg-white border-2 border-green-600 rounded-lg p-2">
                <img src="mpesa.png" alt="M-PESA" class="w-full h-16 object-contain"/>
            </button>
            <button onclick="showPaymentInstructions('Airtel Money')" class="flex-1 bg-white border-2 border-red-600 rounded-lg p-2">
                <img src="visa.jpg" alt="Airtel Money" class="w-full h-16 object-contain"/>
            </button>
        </div>
    </div>
</div>

<!-- Payment Instructions Modal -->
<!-- Payment Instructions Modal (Professional Layout) -->
<div id="paymentInstructionModal" class="fixed inset-0 bg-black bg-opacity-50 hidden z-50 flex justify-center items-center">
  <div class="bg-white text-black rounded-xl p-6 w-[420px]">
    <h2 class="text-xl font-bold mb-4 text-center" id="payTitle">Pay via</h2>
    
    <div class="flex items-center border border-gray-300 rounded-lg p-4 mb-4">
      <img id="payImage" src="mpesa.png" alt="Payment Logo" class="w-16 h-16 object-contain mr-4" />
      <div>
        <p class="text-lg font-semibold" id="payMethodLabel">Go to M-PESA</p>
        <p class="text-sm text-gray-600">Buy Goods and Services</p>
        <p class="text-sm mt-1"><strong>Till Number:</strong> <span id="tillNumber">1234</span></p>
      </div>
    </div>

    <input type="number" id="depositAmount" placeholder="Enter Amount" class="w-full border rounded p-2 mb-2" />
    <input type="text" id="mpesaCode" placeholder="Enter M-PESA Code" class="w-full border rounded p-2 mb-4" />
    
    <button onclick="confirmDeposit()" class="bg-blue-600 text-white px-4 py-2 rounded w-full font-semibold">Confirm Deposit</button>
  </div>
</div>


<!-- Withdraw Method Modal (Side-by-Side Images) -->
<div id="withdrawMethodModal" class="fixed inset-0 bg-black bg-opacity-50 hidden z-50 flex justify-center items-center">
    <div class="bg-white text-black rounded-xl p-6 w-96 text-center">
        <h2 class="text-xl font-bold mb-4">Choose Withdrawal Method</h2>
        <div class="flex justify-between gap-4">
            <button onclick="showWithdrawInstructions('M-PESA')" class="flex-1 bg-white border-2 border-green-600 rounded-lg p-2">
                <img src="mpesa.png" alt="M-PESA" class="w-full h-16 object-contain"/>
            </button>
            <button onclick="showWithdrawInstructions('Airtel Money')" class="flex-1 bg-white border-2 border-red-600 rounded-lg p-2">
                <img src="visa.jpg" alt="Airtel Money" class="w-full h-16 object-contain"/>
            </button>
        </div>
    </div>
</div>


  <!-- Withdraw Instructions Modal -->
<div id="withdrawInstructionModal" class="fixed inset-0 bg-black bg-opacity-50 hidden z-50 flex justify-center items-center">
  <div class="bg-white text-black rounded-xl p-6 w-[420px]">
    <h2 class="text-xl font-bold mb-4 text-center" id="withdrawPayTitle">Withdraw via</h2>
    
    <div class="flex items-center border border-gray-300 rounded-lg p-4 mb-4">
      <img id="withdrawPayImage" src="mpesa.png" alt="Payment Logo" class="w-16 h-16 object-contain mr-4" />
      <div>
        <p class="text-lg font-semibold" id="withdrawPayMethodLabel">To M-PESA</p>
        <p class="text-sm text-gray-600">Enter details to complete</p>
      </div>
    </div>

    <input type="number" id="withdrawAmount" placeholder="Enter Amount" class="w-full border rounded p-2 mb-2" />
    <input type="text" id="withdrawCode" placeholder="Enter Security Code" class="w-full border rounded p-2 mb-4" />
    
    <button onclick="confirmWithdraw()" class="bg-yellow-600 text-white px-4 py-2 rounded w-full font-semibold">Confirm Withdraw</button>
  </div>
</div>



    <!-- SCRIPT -->
    <script>
        let interval;
        let isRunning = localStorage.getItem("isRunning") === "true";
        let gameStartTime = parseFloat(localStorage.getItem("gameStartTime")) || Date.now();
        let crashPoint = parseFloat(localStorage.getItem("crashPoint")) || (Math.random() * 3 + 1).toFixed(2);
        let storedBalance = localStorage.getItem("balance");
        let balance = storedBalance !== null ? parseFloat(storedBalance) : 0.00;

        let bets = JSON.parse(localStorage.getItem("bets")) || {
            bet1: { active: false, placed: false, queued: false, amount: 0, auto: false },
            bet2: { active: false, placed: false, queued: false, amount: 0, auto: false }
        };

        function saveState() {
            localStorage.setItem("balance", balance.toFixed(2));
            localStorage.setItem("isRunning", isRunning);
            localStorage.setItem("crashPoint", crashPoint);
            localStorage.setItem("bets", JSON.stringify(bets));
        }

        function getCurrentMultiplier() {
            const elapsed = (Date.now() - gameStartTime) / 1000;
            return 1 + elapsed * 0.2;
        }

        function updateMultiplier() {
            const multiplier = getCurrentMultiplier();
            document.getElementById("multiplierDisplay").innerText = multiplier.toFixed(2) + "x";
            localStorage.setItem("multiplier", multiplier.toFixed(2));
            return multiplier;
        }

        function updateBalance() {
            document.querySelector(".text-green-400").innerText = balance.toFixed(2) + " KES";
            localStorage.setItem("balance", balance.toFixed(2));
        }

        function startGame() {
            isRunning = true;
            gameStartTime = Date.now();
            crashPoint = (Math.random() * 3 + 1).toFixed(2);
            localStorage.setItem("crashPoint", crashPoint);
            localStorage.setItem("gameStartTime", gameStartTime);
            localStorage.setItem("isRunning", true);

            interval = setInterval(() => {
                const multiplier = updateMultiplier();
                Object.keys(bets).forEach(id => {
                    if (bets[id].active) updateCashoutText(id);
                });

                if (multiplier >= crashPoint) stopGame();
            }, 50);
        }

        function stopGame() {
            clearInterval(interval);
            isRunning = false;
            localStorage.setItem("isRunning", false);

            Object.keys(bets).forEach(id => {
                if (bets[id].active) {
                    bets[id].active = false;
                    setButtonToBet(id);
                }
                if (bets[id].queued || bets[id].auto) {
                    placeNextRound(id);
                }
            });

            saveState();

            setTimeout(() => {
                startGame();
            }, 3000);
        }

        function placeBet(id) {
            const amount = parseFloat(document.getElementById(id).value);

            if (isNaN(amount) || amount <= 0) {
                showModal("Please enter a valid bet amount.");
                return;
            }

            if (amount > balance) {
                showModal("Low balance. Please top up.");
                return;
            }

            if (bets[id].active || bets[id].placed) return;

            if (isRunning) {
                bets[id].queued = true;
                bets[id].amount = amount;
                showModal(`Bet queued for next round: ${amount} KES`);
                saveState();
                return;
            }

            balance -= amount;
            updateBalance();

            bets[id].placed = true;
            bets[id].active = true;
            bets[id].amount = amount;

            setButtonToCashout(id);
            saveState();
        }

        function setButtonToCashout(id) {
            const btn = document.querySelector(`#${id}`).parentElement.parentElement.querySelector("button.w-full");
            btn.innerText = "Cashout";
            btn.classList.remove("bg-green-500");
            btn.classList.add("bg-yellow-400");
            btn.onclick = () => cashOut(id);

            if (!btn.querySelector(".live-win")) {
                const liveSpan = document.createElement("span");
                liveSpan.className = "live-win ml-2 font-bold";
                liveSpan.style.color = "black";
                btn.appendChild(liveSpan);
            }
        }

        function updateCashoutText(id) {
            const multiplier = getCurrentMultiplier();
            const btn = document.querySelector(`#${id}`).parentElement.parentElement.querySelector("button.w-full");
            const liveSpan = btn.querySelector(".live-win");
            if (liveSpan && bets[id].active) {
                const win = (bets[id].amount * multiplier).toFixed(2);
                liveSpan.textContent = `KES ${win}`;
            }
        }

        function setButtonToBet(id) {
            const inputValue = parseFloat(document.getElementById(id).value) || 0;
            const btn = document.querySelector(`#${id}`).parentElement.parentElement.querySelector("button.w-full");

            btn.innerHTML = `Bet <span id="${id}Amount">${inputValue.toFixed(2)}</span> KES`;
            btn.classList.remove("bg-yellow-400");
            btn.classList.add("bg-green-500");
            btn.onclick = () => placeBet(id);

            bets[id].placed = false;
            bets[id].active = false;
            bets[id].amount = 0;

            saveState();
        }

        function cashOut(id) {
            if (!bets[id].active) return;

            const win = (bets[id].amount * getCurrentMultiplier()).toFixed(2);
            balance += parseFloat(win);
            updateBalance();
            showModal(`Cashed out ${win} KES at ${getCurrentMultiplier().toFixed(2)}x`);

            bets[id].active = false;
            setButtonToBet(id);
            saveState();
        }

        function placeNextRound(id) {
            const amount = bets[id].amount;

            if (amount > balance) {
                showModal("Low balance. Please top up.");
                bets[id].queued = false;
                return;
            }

            balance -= amount;
            updateBalance();

            bets[id].queued = false;
            bets[id].placed = true;
            bets[id].active = true;
            setButtonToCashout(id);
            saveState();
        }

        function updateBetButtonLabel(id) {
            const inputValue = parseFloat(document.getElementById(id).value) || 0;
            const btn = document.querySelector(`#${id}`).parentElement.parentElement.querySelector("button.w-full");

            if (!bets[id].active && !bets[id].placed) {
                btn.innerHTML = `Bet <span id="${id}Amount">${inputValue.toFixed(2)}</span> KES`;
            }
        }

        function setBet(id, amount) {
            const input = document.getElementById(id);
            input.value = amount.toFixed(2);
            updateBetButtonLabel(id);
        }

        function increaseBet(id) {
            const input = document.getElementById(id);
            let current = parseFloat(input.value) || 0;
            current += 10;
            input.value = current.toFixed(2);
            updateBetButtonLabel(id);
        }

        function decreaseBet(id) {
            const input = document.getElementById(id);
            let current = parseFloat(input.value) || 0;
            current = Math.max(current - 10, 0);
            input.value = current.toFixed(2);
            updateBetButtonLabel(id);
        }

        function showModal(message, title = "Notification") {
            document.getElementById("modalTitle").innerText = title;
            document.getElementById("modalMessage").innerText = message;
            document.getElementById("modalPopup").classList.remove("hidden");
        }

        function closeModal() {
            document.getElementById("modalPopup").classList.add("hidden");
        }

        function restoreButtonStates() {
            Object.keys(bets).forEach(id => {
                if (bets[id].active) {
                    setButtonToCashout(id);
                } else {
                    setButtonToBet(id);
                }
                updateBetButtonLabel(id);
            });
        }

        // Initialize
        updateBalance();
        restoreButtonStates();
        updateMultiplier();

        if (isRunning) {
            interval = setInterval(() => {
                const multiplier = updateMultiplier();
                Object.keys(bets).forEach(id => {
                    if (bets[id].active) updateCashoutText(id);
                });

                if (multiplier >= crashPoint) stopGame();
            }, 50);
        } else {
            startGame();
        }
    </script>
    <script>
    document.querySelector(".text-green-400").addEventListener("click", () => {
    document.getElementById("balanceModal").classList.remove("hidden");
});

function openDepositMethod() {
    closeAllModals();
    document.getElementById("depositMethodModal").classList.remove("hidden");
}

function showPaymentInstructions(method) {
    closeAllModals();
    document.getElementById("payTitle").innerText = `Pay via ${method}`;
    document.getElementById("paymentInstructionModal").classList.remove("hidden");
}

function confirmDeposit() {
    const amount = parseFloat(document.getElementById("depositAmount").value);
    const code = document.getElementById("mpesaCode").value.trim();

    if (isNaN(amount) || amount <= 0) {
        showModal("Enter a valid amount to deposit.");
        return;
    }

    if (code === "1234") {
        balance += amount;
        updateBalance();
        saveState();
        closeAllModals();
        showModal(`Deposit successful: ${amount.toFixed(2)} KES`);
    } else {
        closeAllModals();
        showModal("Code not validated by NovaBet. Try again in 5 minutes.");
    }
}

function openWithdrawModal() {
    closeAllModals();
    document.getElementById("withdrawModal").classList.remove("hidden");
}

function confirmWithdraw() {
    const amount = parseFloat(document.getElementById("withdrawAmount").value);
    const code = document.getElementById("withdrawCode").value.trim();

    if (isNaN(amount) || amount <= 0) {
        showModal("Enter a valid withdrawal amount.");
        return;
    }

    if (amount > balance) {
        showModal("Insufficient balance.");
        return;
    }

    if (code === "1234") {
        balance -= amount;
        updateBalance();
        saveState();
        closeAllModals();
        showModal(`Withdraw successful: ${amount.toFixed(2)} KES`);
    } else {
        closeAllModals();
        showModal("Invalid security code. Check your email and try again.");
    }
}

function closeAllModals() {
    document.getElementById("balanceModal").classList.add("hidden");
    document.getElementById("depositMethodModal").classList.add("hidden");
    document.getElementById("paymentInstructionModal").classList.add("hidden");
    document.getElementById("withdrawModal").classList.add("hidden");
}
</script>
    <script>
function showPaymentInstructions(method) {
    document.getElementById('depositMethodModal').classList.add('hidden');
    document.getElementById('paymentInstructionModal').classList.remove('hidden');
    
    const payTitle = document.getElementById('payTitle');
    const payImage = document.getElementById('payImage');
    const payLabel = document.getElementById('payMethodLabel');

    if (method === 'M-PESA') {
        payTitle.textContent = 'Pay via M-PESA';
        payImage.src = 'mpesa.png';
        payLabel.textContent = 'Go to M-PESA';
    } else {
        payTitle.textContent = 'Pay via Airtel Money';
        payImage.src = 'visa.jpg';
        payLabel.textContent = 'Go to Airtel Money';
    }
}
</script>
   <script>
function openWithdrawModal() {
    document.getElementById('balanceModal').classList.add('hidden');
    document.getElementById('withdrawMethodModal').classList.remove('hidden');
}

function showWithdrawInstructions(method) {
    document.getElementById('withdrawMethodModal').classList.add('hidden');
    document.getElementById('withdrawInstructionModal').classList.remove('hidden');
    
    const methodLabel = method === 'M-PESA' ? 'To M-PESA' : 'To Airtel Money';
    const logoSrc = method === 'M-PESA' ? 'mpesa.png' : 'visa.jpg';

    document.getElementById('withdrawPayTitle').innerText = 'Withdraw via ' + method;
    document.getElementById('withdrawPayMethodLabel').innerText = methodLabel;
    document.getElementById('withdrawPayImage').src = logoSrc;
}
</script>



</body>
</html>
